<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vladimír Holý &amp; Petra Tomanová" />

<meta name="date" content="2023-06-25" />

<title>Case Study: Bookshop Orders</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Case Study: Bookshop Orders</h1>
<h4 class="author">Vladimír Holý &amp; Petra Tomanová</h4>
<h4 class="date">2023-06-25</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>We loosely follow Tomanová and Holý (2021) and analyze the timing of
orders from a Czech antiquarian bookshop. Besides seasonality and
diurnal patterns, one would expect the times of orders to be independent
of each other. However, this is not the case and we use a GAS model to
capture dependence between the times of orders.</p>
<p>A strand of financial econometrics is devoted to analyzing the timing
of transactions by the so-called autoregressive conditional duration
(ACD) model introduced by Engle and Russell (1998). For a textbook
treatment of such financial point processes, see e.g. Hautsch
(2012).</p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data Preparation</h2>
<p>Let us prepare the analyzed data. We use the
<code>bookshop_sales</code> dataset containing times of orders from June
8, 2018 to December 20, 2018. We calculate differences of subsequent
times, i.e. durations. To avoid zero durations, we set them to 0.5
second.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(gasmodel)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">data</span>(bookshop_sales)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>data_dur <span class="ot">&lt;-</span> bookshop_sales <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fu">as.numeric</span>(time <span class="sc">-</span> <span class="fu">lag</span>(time)) <span class="sc">/</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fu">recode</span>(duration, <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">just =</span> <span class="fu">as.vector</span>(<span class="fu">as.POSIXct</span>(<span class="fu">format</span>(time, <span class="st">&quot;1970-01-01 %H:%M:%S&quot;</span>), <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
</div>
<div id="diurnal-adjustment" class="section level2">
<h2>Diurnal Adjustment</h2>
<p>We adjust the observed durations for diurnal pattern and extract the
time series to be analyzed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>model_spline <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(data_dur<span class="sc">$</span>just, data_dur<span class="sc">$</span>duration, <span class="at">df =</span> <span class="dv">10</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>data_dur <span class="ot">&lt;-</span> data_dur <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration_spline =</span> <span class="fu">predict</span>(model_spline, <span class="at">x =</span> just)<span class="sc">$</span>y) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration_adj =</span> duration <span class="sc">/</span> duration_spline) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>just)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> data_dur<span class="sc">$</span>duration_adj</span></code></pre></div>
</div>
<div id="model-estimation" class="section level2">
<h2>Model Estimation</h2>
<p>The following distributions are available for our data type. We
utilize the generalized gamma family.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">distr</span>(<span class="at">filter_type =</span> <span class="st">&quot;duration&quot;</span>, <span class="at">filter_dim =</span> <span class="st">&quot;uni&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;          distr_title param_title    distr param     type dim orthog default</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 6  Birnbaum-Saunders       Scale     bisa scale duration uni   TRUE    TRUE</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 10       Exponential        Rate      exp  rate duration uni   TRUE   FALSE</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 11       Exponential       Scale      exp scale duration uni   TRUE    TRUE</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 12             Gamma        Rate    gamma  rate duration uni  FALSE   FALSE</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 13             Gamma       Scale    gamma scale duration uni  FALSE    TRUE</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 14 Generalized Gamma        Rate gengamma  rate duration uni  FALSE   FALSE</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 15 Generalized Gamma       Scale gengamma scale duration uni  FALSE    TRUE</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 31           Weibull        Rate  weibull  rate duration uni  FALSE   FALSE</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 32           Weibull       Scale  weibull scale duration uni  FALSE    TRUE</span></span></code></pre></div>
<p>First, we estimate the model based on the exponential distribution.
By default, the logarithmic link for the time-varying scale parameter is
adopted. In this particular case, the Fisher information is constant and
the three scalings are therefore equivalent.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>est_exp <span class="ot">&lt;-</span> <span class="fu">gas</span>(<span class="at">y =</span> y, <span class="at">distr =</span> <span class="st">&quot;exp&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>est_exp</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; GAS Model: Exponential Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Coefficients: </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;                      Estimate  Std. Error   Z-Test  Pr(&gt;|Z|)    </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; log(scale)_omega  -0.00085202  0.00114896  -0.7416    0.4584    </span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; log(scale)_alpha1  0.04888439  0.00650562   7.5142 5.727e-14 ***</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; log(scale)_phi1    0.96343265  0.00910508 105.8126 &lt; 2.2e-16 ***</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -5608.518, AIC: 11223.04, BIC: 11243.01</span></span></code></pre></div>
<p>Second, we estimate the model based on the Weibull distribution.
Compared to the exponential distribution, it has an additional shape
parameter. By default, the first parameter is assumed time-varying while
the remaining are assumed static. In our case, the model features the
time-varying scale parameter with the constant shape parameter. However,
it is possible to modify this behavior using the <code>par_static</code>
argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>est_weibull <span class="ot">&lt;-</span> <span class="fu">gas</span>(<span class="at">y =</span> y, <span class="at">distr =</span> <span class="st">&quot;weibull&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>est_weibull</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; GAS Model: Weibull Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; Coefficients: </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error   Z-Test  Pr(&gt;|Z|)    </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; log(scale)_omega  -0.0019175  0.0013552  -1.4149    0.1571    </span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; log(scale)_alpha1  0.0562619  0.0082010   6.8604 6.867e-12 ***</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; log(scale)_phi1    0.9622643  0.0102230  94.1278 &lt; 2.2e-16 ***</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; shape              0.9442209  0.0094299 100.1300 &lt; 2.2e-16 ***</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -5591.442, AIC: 11190.88, BIC: 11217.51</span></span></code></pre></div>
<p>Third, we estimate the model based on the gamma distribution. This is
another generalization of the exponential distribution with an
additional shape parameter.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>est_gamma <span class="ot">&lt;-</span> <span class="fu">gas</span>(<span class="at">y =</span> y, <span class="at">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>est_gamma</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; GAS Model: Gamma Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Coefficients: </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error   Z-Test  Pr(&gt;|Z|)    </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; log(scale)_omega  0.0013296  0.0013395   0.9926    0.3209    </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; log(scale)_alpha1 0.0518896  0.0071672   7.2399 4.491e-13 ***</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; log(scale)_phi1   0.9634327  0.0093853 102.6532 &lt; 2.2e-16 ***</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; shape             0.9420850  0.0153854  61.2325 &lt; 2.2e-16 ***</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -5601.735, AIC: 11211.47, BIC: 11238.1</span></span></code></pre></div>
<p>Fourth, we estimate the model based on the generalized gamma
distribution. The generalized gamma distribution encompasses all three
aforementioned distributions as special cases.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>est_gengamma <span class="ot">&lt;-</span> <span class="fu">gas</span>(<span class="at">y =</span> y, <span class="at">distr =</span> <span class="st">&quot;gengamma&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>est_gengamma</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; GAS Model: Generalized Gamma Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Coefficients: </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error  Z-Test  Pr(&gt;|Z|)    </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; log(scale)_omega  -0.049164   0.018903 -2.6009  0.009299 ** </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; log(scale)_alpha1  0.069834   0.011670  5.9841 2.176e-09 ***</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; log(scale)_phi1    0.951761   0.015024 63.3493 &lt; 2.2e-16 ***</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; shape1             1.764362   0.150759 11.7032 &lt; 2.2e-16 ***</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; shape2             0.682971   0.033690 20.2723 &lt; 2.2e-16 ***</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -5562.092, AIC: 11134.18, BIC: 11167.47</span></span></code></pre></div>
<p>By comparing the Akaike information criterion (AIC), we find that the
most general model, i.e. the one based on the generalized gamma
distribution, is the most suitable. For this purpose, we use generic
function <code>AIC()</code>. Alternatively, the AIC of an estimated
model is stored in <code>est_gengamma$fit$aic</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">AIC</span>(est_exp, est_weibull, est_gamma, est_gengamma)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;              df      AIC</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; est_exp       3 11223.04</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; est_weibull   4 11190.88</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; est_gamma     4 11211.47</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; est_gengamma  5 11134.18</span></span></code></pre></div>
</div>
<div id="bootstrapping" class="section level2">
<h2>Bootstrapping</h2>
<p>To assess the suitability of standard deviations based on asymptotics
for our finite sample, we employ the <code>gas_bootstrap()</code>
function. This function conducts a parametric bootstrap, allowing us to
calculate standard errors and quantiles. It’s important to note that
this could be computationally very intensive, depending on the number of
repetitions, the quantity of observations, the complexity of the model
structure, and the optimizer used.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>boot_gengamma <span class="ot">&lt;-</span> <span class="fu">gas_bootstrap</span>(est_gengamma)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>boot_gengamma</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; GAS Model: Generalized Gamma Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Method: Parametric Bootstrap </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Number of Bootstrap Samples: 1000 </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Bootstrapped Coefficients: </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;                      Original        Mean  Std. Error        2.5%       97.5%</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; log(scale)_omega  -0.04916436 -0.05108068 0.014553055 -0.08273803 -0.02706646</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; log(scale)_alpha1  0.06983394  0.07002813 0.008656187  0.05377361  0.08715991</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; log(scale)_phi1    0.95176106  0.94977473 0.011273494  0.92340871  0.96741980</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; shape1             1.76436199  1.76852180 0.156548275  1.48360992  2.10490423</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; shape2             0.68297060  0.68483367 0.035019326  0.61957228  0.75425789</span></span></code></pre></div>
<p>Given that the number of observations in our model is 5752
(accessible through <code>est_gengamma$model$t</code>), it is reasonable
to anticipate that standard deviations based on asymptotics would yield
precise results. Fortunately, this holds true in our scenario. Note that
standard deviations can also be obtained using the <code>vcov()</code>
generic function for both <code>est_gengamma</code> and
<code>boot_gengamma</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>est_gengamma<span class="sc">$</span>fit<span class="sc">$</span>coef_sd <span class="sc">-</span> boot_gengamma<span class="sc">$</span>bootstrap<span class="sc">$</span>coef_sd</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt;  log(scale)_omega log(scale)_alpha1   log(scale)_phi1            shape1            shape2 </span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;       0.004349924       0.003013722       0.003750529      -0.005789689      -0.001329515</span></span></code></pre></div>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>Lastly, we highlight the utilization of simulation techniques.
Simulation is executed using the <code>gas_simulate()</code> function,
which can be supplied with either an estimated model or a custom model
structure.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>sim_gengamma <span class="ot">&lt;-</span> <span class="fu">gas_simulate</span>(est_gengamma, <span class="at">t_sim =</span> <span class="dv">20</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>sim_gengamma</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; GAS Model: Generalized Gamma Distribution / Scale Parametrization / Unit Scaling </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; Simulations: </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;          t1          t2          t3          t4          t5          t6          t7          t8 </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 1.274093885 0.884734423 1.433960897 0.140393911 0.320915730 2.925334846 2.854427295 0.920530032 </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;          t9         t10         t11         t12         t13         t14         t15         t16 </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 0.854565486 0.331341832 0.006232464 0.102167045 0.819162543 1.067127343 1.488868243 0.204069391 </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;         t17         t18         t19         t20 </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; 0.162374836 0.131711352 0.858940205 0.285970954</span></span></code></pre></div>
<p>The simulated time series can be employed, for example, to assess the
impact of order arrivals on queuing systems, as demonstrated by Tomanová
and Holý (2021).</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Engle, R. F. and Russell, J. R. (1998). Autoregressive Conditional
Duration: A New Model for Irregularly Spaced Transaction Data.
<em>Econometrica</em>, <strong>66</strong>(5), 1127–1162. doi: <a href="https://doi.org/10.2307/2999632">10.2307/2999632</a>.</p>
<p>Hautsch, N. (2012). <em>Econometrics of Financial High-Frequency
Data</em>. Springer. doi: <a href="https://doi.org/10.1007/978-3-642-21925-2">10.1007/978-3-642-21925-2</a>.</p>
<p>Tomanová, P. and Holý, V. (2021). Clustering of Arrivals in Queueing
Systems: Autoregressive Conditional Duration Approach. <em>Central
European Journal of Operations Research</em>, <strong>29</strong>(3),
859–874. doi: <a href="https://doi.org/10.1007/s10100-021-00744-7">10.1007/s10100-021-00744-7</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
